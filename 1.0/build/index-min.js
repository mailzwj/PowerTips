/*! powerTips - v1.0 - 2013-06-25 2:30:11 PM
* Copyright (c) 2013 Letao; Licensed  */
KISSY.add("gallery/powerTips/1.0/index",function(a,b,c){function d(b){var c=this;c.triggers=e(b.triggers),b.location||(b.location=[]),b.location[0]=b.location[0]?b.location[0]:"right",b.location[1]=b.location[1]?b.location[1]:"middle",c.location=b.location,c.textAttr=b.textAttr||"title",c.theme=b.theme,c.spacing=c.spacing||3,c.tipId=a.guid("J_PT"),c.tip=c.createTip(c.tipId),c.tc=a.one(c.tip).one(".ks-ptcontent"),c.init()}var e=b.all,f=a.DOM;a.Event;var g={top:{left:"topleft",center:"topcenter",right:"topright"},right:{top:"righttop",middle:"rightmiddle",bottom:"rightbottom"},bottom:{left:"bottomleft",center:"bottomcenter",right:"bottomright"},left:{top:"lefttop",middle:"leftmiddle",bottom:"leftbottom"}},h={red:"ks-PowerTips_red",blue:"ks-PowerTips_blue",orange:"ks-PowerTips_orange",purple:"ks-PowerTips_purple"};return a.extend(d,c,{init:function(){var a=this;a.bindEvent()},bindEvent:function(){var b=this;b.triggers.on("mouseover",function(){this.locStart=b.location[0],this.locEnd=b.location[1],a.one(this).attr(b.textAttr)&&""!==a.one(this).attr(b.textAttr)&&(b.setContent(this),b.setLocation(this),b.show())}).on("mouseout",function(){b.hide()})},setLocation:function(b){var c=this,d=a.one(b).offset(),f={width:a.one(b).width(),height:a.one(b).height()},h={},i=25,j=/ks\-pt\w+(\s+|$)/g;if(c.tip.css("display","block"),h.width=c.tip.outerWidth(),h.height=c.tip.outerHeight(),c.tip.css("display","none"),"left"===b.locStart){var k=d.left-h.width-c.spacing,l=d.top+(f.height-h.height)/2,m=d.top-(h.height-i),n=d.top+f.height-i;0>k&&(b.locStart="right"),n+h.height>e(window).height()&&(b.locEnd=l+h.height>e(window).height()?"top":"middle"),0>m&&(b.locEnd=0>l?"bottom":"middle")}else if("right"===b.locStart){var o=d.left+f.width+c.spacing,m=d.top-(h.height-i),l=d.top+(f.height-h.height)/2,n=d.top+f.height-i;o+h.width>e(window).width()&&(b.locStart="left"),n+h.height>e(window).height()&&(b.locEnd=l+h.height>e(window).height()?"top":"middle"),0>m&&(b.locEnd=0>l?"bottom":"middle")}else if("top"===b.locStart){var p=d.top-h.height-c.spacing,q=d.left-(h.width-i),r=d.left+(f.width-h.width)/2,s=d.left+f.width-i;0>p&&(b.locStart="bottom"),s+h.width>e(window).width()&&(b.locEnd=r+h.width>e(window).width()?"left":"center"),0>q&&(b.locEnd=0>r?"right":"center")}else if("bottom"===b.locStart){var t=d.top+f.height+c.spacing,q=d.left-(h.width-i),r=d.left+(f.width-h.width)/2,s=d.left+f.width-i;t+h.height>e(window).height()&&(b.locStart="top"),s+h.width>e(window).width()&&(b.locEnd=r+h.width>e(window).width()?"left":"center"),0>q&&(b.locEnd=0>r?"right":"center")}switch(j.test(c.tip.one(".J_Arrow").attr("class"))?c.tip.one(".J_Arrow").attr("class",c.tip.one(".J_Arrow").attr("class").replace(j,"ks-pt"+g[b.locStart][b.locEnd])):c.tip.one(".J_Arrow").addClass("ks-pt"+g[b.locStart][b.locEnd]),g[b.locStart][b.locEnd]){case"leftmiddle":c.writeStyle(d.left-h.width-c.spacing,d.top+(f.height-h.height)/2);break;case"leftbottom":c.writeStyle(d.left-h.width-c.spacing,d.top+f.height-i);break;case"lefttop":c.writeStyle(d.left-h.width-c.spacing,d.top-h.height+i);break;case"righttop":c.writeStyle(d.left+f.width+c.spacing,d.top-h.height+i);break;case"rightbottom":c.writeStyle(d.left+f.width+c.spacing,d.top+f.height-i);break;case"topleft":c.writeStyle(d.left-h.width+i,d.top-h.height-c.spacing);break;case"topcenter":c.writeStyle(d.left+(f.width-h.width)/2,d.top-h.height-c.spacing);break;case"topright":c.writeStyle(d.left+f.width-i,d.top-h.height-c.spacing);break;case"bottomleft":c.writeStyle(d.left-h.width+i,d.top+f.height+c.spacing);break;case"bottomcenter":c.writeStyle(d.left+(f.width-h.width)/2,d.top+f.height+c.spacing);break;case"bottomright":c.writeStyle(d.left+f.width-i,d.top+f.height+c.spacing);break;default:c.writeStyle(d.left+f.width+c.spacing,d.top+(f.height-h.height)/2)}},writeStyle:function(a,b){var c=this;c.tip.css({left:a,top:b})},createTip:function(b){var c=this,d=f.create("<div>");return f.attr(d,"id",b),f.html(d,'<i class="J_Arrow ks-arrow"></i><div class="ks-ptcontent"></div>'),f.addClass(d,"ks-PowerTips_overlay"),h[c.theme]&&f.addClass(d,h[c.theme]),a.one("body").append(d),a.one(d)},setContent:function(b){var c=this;c.tc.html(a.one(b).attr(c.textAttr))},show:function(){var b=this;a.one(b.tip).css({display:"block"})},hide:function(){var b=this;a.all(b.tip).css("display","none")}},{ATTRS:{}}),d},{requires:["node","base"]});